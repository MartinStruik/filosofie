<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Philo-Scan - Oostvaarders College</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #a5b4fc;
            --secondary: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --dark: #1e1b4b;
            --gray-900: #111827;
            --gray-700: #374151;
            --gray-500: #6b7280;
            --gray-300: #d1d5db;
            --gray-100: #f3f4f6;
            --white: #ffffff;

            /* Domain colors */
            --begrijpen: #3b82f6;
            --denken: #8b5cf6;
            --praten: #f59e0b;
            --schrijven: #10b981;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #1e1b4b 100%);
            min-height: 100vh;
            color: var(--white);
            overflow-x: hidden;
        }

        /* Animated background */
        .bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.03;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 1.5rem;
            position: relative;
            z-index: 1;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Screens */
        .screen {
            display: none;
            flex: 1;
            flex-direction: column;
        }

        .screen.active {
            display: flex;
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Header */
        .header {
            text-align: center;
            padding: 1rem 0;
        }

        .logo {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--primary-light);
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 0.25rem;
        }

        .brand {
            font-size: 2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--white) 0%, var(--primary-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Intro Screen */
        .intro-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: center;
            padding: 2rem 0;
        }

        .intro-icon {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            animation: float 3s ease-in-out infinite;
        }

        .intro-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            line-height: 1.3;
        }

        .intro-subtitle {
            color: var(--gray-300);
            font-size: 1rem;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .intro-features {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .intro-feature {
            text-align: center;
        }

        .intro-feature-icon {
            font-size: 1.5rem;
            margin-bottom: 0.3rem;
        }

        .intro-feature-text {
            font-size: 0.8rem;
            color: var(--gray-300);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.5);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.15);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Question Screen */
        .question-header {
            padding: 1rem 0;
        }

        .progress-bar {
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            margin-bottom: 0.5rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--gray-300);
        }

        .question-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 2rem 0;
        }

        .question-domain {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            margin-bottom: 1.5rem;
            width: fit-content;
        }

        .question-domain.begrijpen { background: rgba(59, 130, 246, 0.2); color: #93c5fd; }
        .question-domain.denken { background: rgba(139, 92, 246, 0.2); color: #c4b5fd; }
        .question-domain.praten { background: rgba(245, 158, 11, 0.2); color: #fcd34d; }
        .question-domain.schrijven { background: rgba(16, 185, 129, 0.2); color: #6ee7b7; }

        .question-text {
            font-size: 1.4rem;
            font-weight: 600;
            line-height: 1.4;
            margin-bottom: 2rem;
        }

        .answer-scale {
            display: flex;
            justify-content: space-between;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .scale-option {
            flex: 1;
            aspect-ratio: 1;
            max-width: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }

        .scale-option:hover {
            background: rgba(255,255,255,0.1);
            border-color: rgba(255,255,255,0.3);
        }

        .scale-option.selected {
            background: var(--primary);
            border-color: var(--primary);
            transform: scale(1.1);
        }

        .scale-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: var(--gray-500);
        }

        .question-nav {
            display: flex;
            gap: 1rem;
            padding: 1rem 0;
        }

        .question-nav .btn {
            flex: 1;
        }

        /* Results Screen */
        .results-content {
            flex: 1;
            padding: 1rem 0;
        }

        .archetype-card {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2) 0%, rgba(139, 92, 246, 0.2) 100%);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
        }

        .archetype-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .archetype-label {
            font-size: 0.8rem;
            color: var(--gray-300);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 0.5rem;
        }

        .archetype-name {
            font-size: 1.8rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }

        .archetype-subtitle {
            color: var(--gray-300);
            font-size: 0.9rem;
        }

        .scores-grid {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .score-bar {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 1rem;
        }

        .score-bar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .score-bar-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }

        .score-bar-label .icon {
            font-size: 1.2rem;
        }

        .score-bar-value {
            font-weight: 700;
            color: var(--gray-300);
        }

        .score-bar-track {
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .score-bar-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.8s ease;
        }

        .score-bar.begrijpen .score-bar-fill { background: var(--begrijpen); }
        .score-bar.denken .score-bar-fill { background: var(--denken); }
        .score-bar.praten .score-bar-fill { background: var(--praten); }
        .score-bar.schrijven .score-bar-fill { background: var(--schrijven); }

        /* Goal Screen */
        .goal-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .goal-card:hover {
            background: rgba(255,255,255,0.08);
            border-color: rgba(255,255,255,0.2);
        }

        .goal-card.selected {
            background: rgba(99, 102, 241, 0.2);
            border-color: var(--primary);
        }

        .goal-card.recommended {
            border-color: var(--secondary);
        }

        .goal-card .badge {
            display: inline-block;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            background: var(--secondary);
            color: var(--dark);
            margin-bottom: 0.75rem;
        }

        .goal-card h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .goal-card p {
            font-size: 0.85rem;
            color: var(--gray-300);
        }

        /* Challenge Screen */
        .challenge-option {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 1.25rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .challenge-option:hover {
            background: rgba(255,255,255,0.08);
            border-color: rgba(255,255,255,0.2);
        }

        .challenge-option.selected {
            background: rgba(99, 102, 241, 0.15);
            border-color: var(--primary);
        }

        .challenge-option h4 {
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }

        .challenge-option p {
            font-size: 0.8rem;
            color: var(--gray-400);
        }

        /* Ticket Screen */
        .ticket {
            background: var(--white);
            color: var(--gray-900);
            border-radius: 20px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .ticket-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 1.5rem;
            text-align: center;
        }

        .ticket-header h2 {
            font-size: 1.3rem;
            margin-bottom: 0.25rem;
        }

        .ticket-header p {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .ticket-body {
            padding: 1.5rem;
        }

        .ticket-row {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px dashed var(--gray-300);
        }

        .ticket-row:last-child {
            border-bottom: none;
        }

        .ticket-label {
            font-size: 0.8rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .ticket-value {
            font-weight: 600;
            text-align: right;
        }

        .ticket-challenge {
            background: var(--gray-100);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .ticket-challenge h4 {
            font-size: 0.8rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
        }

        .ticket-challenge p {
            font-weight: 600;
            color: var(--primary-dark);
        }

        .ticket-footer {
            text-align: center;
            padding: 1rem;
            background: var(--gray-100);
            font-size: 0.8rem;
            color: var(--gray-500);
        }

        .action-buttons {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .action-buttons .btn {
            flex: 1;
            min-width: 120px;
        }

        /* Loading animation */
        .loading {
            text-align: center;
            padding: 3rem;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255,255,255,0.1);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Section titles */
        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .section-subtitle {
            color: var(--gray-300);
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
        }

        /* Print styles */
        @media print {
            body {
                background: white;
                color: black;
            }
            .container {
                max-width: 100%;
            }
            .btn, .action-buttons {
                display: none !important;
            }
            .ticket {
                box-shadow: none;
                border: 2px solid #000;
            }
        }

        /* Footer link */
        .footer-link {
            text-align: center;
            padding: 1rem;
            margin-top: auto;
        }

        .footer-link a {
            color: var(--gray-400);
            text-decoration: none;
            font-size: 0.85rem;
        }

        .footer-link a:hover {
            color: var(--white);
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">Oostvaarders College</div>
            <div class="brand">Philo-Scan</div>
        </div>

        <!-- Screen 1: Intro -->
        <div id="screen-intro" class="screen active">
            <div class="intro-content">
                <div class="intro-icon">üîÆ</div>
                <h1 class="intro-title">Ontdek jouw filosofische superkracht</h1>
                <p class="intro-subtitle">
                    Geen cijfer, geen oordeel. Wel: ontdekken waar jij goed in bent en waar je kunt groeien.
                </p>

                <div class="intro-features">
                    <div class="intro-feature">
                        <div class="intro-feature-icon">‚ö°</div>
                        <div class="intro-feature-text">2-3 min</div>
                    </div>
                    <div class="intro-feature">
                        <div class="intro-feature-icon">üéØ</div>
                        <div class="intro-feature-text">8 vragen</div>
                    </div>
                    <div class="intro-feature">
                        <div class="intro-feature-icon">üöÄ</div>
                        <div class="intro-feature-text">Direct resultaat</div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="startScan()">
                    Start de scan
                    <span>‚Üí</span>
                </button>
            </div>

            <div class="footer-link">
                <a href="index.html">‚Üê Terug naar Filosofie</a>
            </div>
        </div>

        <!-- Screen 2: Questions -->
        <div id="screen-questions" class="screen">
            <div class="question-header">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-text">
                    <span id="progress-label">Vraag 1 van 8</span>
                    <span id="progress-percent">0%</span>
                </div>
            </div>

            <div class="question-content">
                <div class="question-domain" id="question-domain">
                    <span class="domain-icon"></span>
                    <span class="domain-name"></span>
                </div>
                <div class="question-text" id="question-text"></div>

                <div class="answer-scale" id="answer-scale">
                    <!-- Generated by JS -->
                </div>
                <div class="scale-labels">
                    <span>Nee</span>
                    <span>Ja</span>
                </div>
            </div>

            <div class="question-nav">
                <button class="btn btn-secondary" id="btn-prev" onclick="prevQuestion()" disabled>Vorige</button>
                <button class="btn btn-primary" id="btn-next" onclick="nextQuestion()" disabled>Volgende</button>
            </div>
        </div>

        <!-- Screen 3: Loading -->
        <div id="screen-loading" class="screen">
            <div class="loading" style="flex:1; display:flex; flex-direction:column; justify-content:center;">
                <div class="loading-spinner"></div>
                <p>Je profiel wordt berekend...</p>
            </div>
        </div>

        <!-- Screen 4: Results -->
        <div id="screen-results" class="screen">
            <div class="results-content">
                <div class="archetype-card" id="archetype-card">
                    <!-- Generated by JS -->
                </div>

                <h3 class="section-title">Jouw scores</h3>
                <p class="section-subtitle">Hoe scoor je op de vier filosofie-vaardigheden?</p>

                <div class="scores-grid" id="scores-grid">
                    <!-- Generated by JS -->
                </div>

                <button class="btn btn-primary" onclick="showGoalScreen()" style="width:100%;">
                    Bekijk je groeidoel
                    <span>‚Üí</span>
                </button>
            </div>
        </div>

        <!-- Screen 5: Goal Selection -->
        <div id="screen-goal" class="screen">
            <div style="flex:1; padding: 1rem 0;">
                <h2 class="section-title">Kies je groeidoel</h2>
                <p class="section-subtitle" id="goal-subtitle">We raden je aan om te focussen op je grootste groeikans.</p>

                <div id="goal-options">
                    <!-- Generated by JS -->
                </div>

                <button class="btn btn-primary" id="btn-goal-next" onclick="showChallengeScreen()" style="width:100%; margin-top:1rem;" disabled>
                    Kies een challenge
                    <span>‚Üí</span>
                </button>
            </div>
        </div>

        <!-- Screen 6: Challenge Selection -->
        <div id="screen-challenge" class="screen">
            <div style="flex:1; padding: 1rem 0;">
                <h2 class="section-title">Kies je challenge</h2>
                <p class="section-subtitle" id="challenge-subtitle">Kies √©√©n tactiek voor de komende 2 weken.</p>

                <div id="challenge-options">
                    <!-- Generated by JS -->
                </div>

                <button class="btn btn-primary" id="btn-challenge-next" onclick="showTicketScreen()" style="width:100%; margin-top:1rem;" disabled>
                    Maak mijn ticket
                    <span>‚Üí</span>
                </button>
            </div>
        </div>

        <!-- Screen 7: Ticket -->
        <div id="screen-ticket" class="screen">
            <div style="flex:1; padding: 1rem 0;">
                <h2 class="section-title" style="text-align:center;">Jouw Philo-Ticket</h2>
                <p class="section-subtitle" style="text-align:center;">Bewaar dit als herinnering aan je doel.</p>

                <div class="ticket" id="ticket">
                    <!-- Generated by JS -->
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="window.print()">
                        üñ®Ô∏è Print
                    </button>
                    <button class="btn btn-secondary" onclick="retryTest()">
                        üîÑ Opnieuw
                    </button>
                    <a href="index.html" class="btn btn-primary">
                        ‚úì Klaar
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== DATA ====================

        const domains = {
            begrijpen: {
                name: 'Begrijpen',
                icon: 'üìñ',
                color: '#3b82f6',
                description: 'Teksten lezen en doorgronden'
            },
            denken: {
                name: 'Denken',
                icon: 'üß†',
                color: '#8b5cf6',
                description: 'Scherp en kritisch nadenken'
            },
            praten: {
                name: 'Praten',
                icon: 'üí¨',
                color: '#f59e0b',
                description: 'In gesprek gaan en luisteren'
            },
            schrijven: {
                name: 'Schrijven',
                icon: '‚úçÔ∏è',
                color: '#10b981',
                description: 'Helder formuleren en opbouwen'
            }
        };

        const archetypes = {
            begrijpen: {
                name: 'Tekstkraker',
                icon: 'üìñ',
                subtitle: 'Je haalt de kern uit elke tekst'
            },
            denken: {
                name: 'Scherpschutter',
                icon: 'üéØ',
                subtitle: 'Je prikt door vage argumenten heen'
            },
            praten: {
                name: 'Debater',
                icon: 'üó£Ô∏è',
                subtitle: 'Je durft te spreken √©n te luisteren'
            },
            schrijven: {
                name: 'Bouwer',
                icon: 'üèóÔ∏è',
                subtitle: 'Je bouwt heldere antwoorden op'
            }
        };

        const questions = [
            { id: 1, domain: 'begrijpen', text: 'Ik kan de kern uit een moeilijke tekst halen.' },
            { id: 2, domain: 'begrijpen', text: 'Ik kan in mijn eigen woorden uitleggen wat ik gelezen heb.' },
            { id: 3, domain: 'denken', text: 'Ik vraag door als iemand iets zegt: "waarom denk je dat?"' },
            { id: 4, domain: 'denken', text: 'Ik merk het als iets niet goed klopt (bijvoorbeeld tegenstrijdig is).' },
            { id: 5, domain: 'praten', text: 'Ik durf mijn mening te zeggen in de les.' },
            { id: 6, domain: 'praten', text: 'Ik luister echt naar anderen om ze te begrijpen.' },
            { id: 7, domain: 'schrijven', text: 'Ik kan helder opschrijven wat ik bedoel.' },
            { id: 8, domain: 'schrijven', text: 'Ik kan mijn antwoord stap voor stap opbouwen.' }
        ];

        const challenges = {
            begrijpen: [
                {
                    name: 'Kernzin markeren',
                    description: 'Markeer bij elke alinea de belangrijkste zin.'
                },
                {
                    name: '2-zinnen-samenvatting',
                    description: 'Vat elke tekst samen in precies 2 zinnen.'
                },
                {
                    name: 'Mini-woordenlijst',
                    description: 'Schrijf 3 moeilijke woorden op en zoek ze op.'
                }
            ],
            denken: [
                {
                    name: 'Waarom-vraag',
                    description: 'Stel elke les minstens √©√©n "waarom?"-vraag.'
                },
                {
                    name: 'Check de sprong',
                    description: 'Vraag jezelf: volgt de conclusie echt uit de argumenten?'
                },
                {
                    name: 'Voorbeeld-test',
                    description: 'Bedenk een voorbeeld dat een stelling weerlegt.'
                }
            ],
            praten: [
                {
                    name: '1 mening + 1 reden',
                    description: 'Geef elke les je mening met √©√©n onderbouwing.'
                },
                {
                    name: 'Eerst herhalen',
                    description: 'Zeg "dus jij bedoelt..." voordat je reageert.'
                },
                {
                    name: '1 vraag per les',
                    description: 'Stel elke les √©√©n vraag aan een klasgenoot.'
                }
            ],
            schrijven: [
                {
                    name: '3-stappen-antwoord',
                    description: 'Structureer elk antwoord: stelling ‚Üí argument ‚Üí conclusie.'
                },
                {
                    name: 'Korte zinnen',
                    description: 'Schrijf zinnen van max. 15 woorden.'
                },
                {
                    name: 'Mini-conclusie',
                    description: 'Eindig elk antwoord met "Dus..." of "Daarom...".'
                }
            ],
            verdieping: [
                {
                    name: 'Sterkste tegenargument',
                    description: 'Bedenk het beste argument tegen je eigen mening.'
                },
                {
                    name: 'Precisie-check',
                    description: 'Herformuleer elke zin tot hij niet preciezer kan.'
                },
                {
                    name: 'Verbindingen leggen',
                    description: 'Leg een link tussen deze les en een eerdere les.'
                }
            ]
        };

        // ==================== STATE ====================

        let currentQuestion = 0;
        let answers = {};
        let scores = {};
        let selectedGoal = null;
        let selectedChallenge = null;
        let isAdvanced = false;

        // ==================== FUNCTIONS ====================

        function startScan() {
            showScreen('screen-questions');
            showQuestion(0);
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        function showQuestion(index) {
            const q = questions[index];
            const domain = domains[q.domain];

            // Update progress
            const progress = (index / questions.length) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            document.getElementById('progress-label').textContent = `Vraag ${index + 1} van ${questions.length}`;
            document.getElementById('progress-percent').textContent = Math.round(progress) + '%';

            // Update domain badge
            const domainEl = document.getElementById('question-domain');
            domainEl.className = 'question-domain ' + q.domain;
            domainEl.innerHTML = `<span>${domain.icon}</span><span>${domain.name}</span>`;

            // Update question text
            document.getElementById('question-text').textContent = q.text;

            // Generate answer scale
            const scaleHtml = [1, 2, 3, 4, 5].map(val => `
                <div class="scale-option ${answers[q.id] === val ? 'selected' : ''}"
                     onclick="selectAnswer(${q.id}, ${val})">
                    ${val}
                </div>
            `).join('');
            document.getElementById('answer-scale').innerHTML = scaleHtml;

            // Update navigation
            document.getElementById('btn-prev').disabled = index === 0;
            document.getElementById('btn-next').textContent = index === questions.length - 1 ? 'Bekijk resultaat' : 'Volgende';
            document.getElementById('btn-next').disabled = !answers[q.id];
        }

        function selectAnswer(questionId, value) {
            answers[questionId] = value;

            // Update visual
            document.querySelectorAll('.scale-option').forEach((opt, i) => {
                opt.classList.toggle('selected', i + 1 === value);
            });

            document.getElementById('btn-next').disabled = false;
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            } else {
                showLoadingScreen();
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
            }
        }

        function showLoadingScreen() {
            showScreen('screen-loading');
            setTimeout(() => {
                calculateScores();
                showResultsScreen();
            }, 1500);
        }

        function calculateScores() {
            scores = {
                begrijpen: (answers[1] || 0) + (answers[2] || 0),
                denken: (answers[3] || 0) + (answers[4] || 0),
                praten: (answers[5] || 0) + (answers[6] || 0),
                schrijven: (answers[7] || 0) + (answers[8] || 0)
            };

            // Check if advanced (all scores >= 8, which means avg >= 4)
            const avgScore = Object.values(scores).reduce((a, b) => a + b, 0) / 4;
            isAdvanced = avgScore >= 8;
        }

        function showResultsScreen() {
            showScreen('screen-results');

            // Find highest and lowest
            const sorted = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const highest = sorted[0][0];
            const lowest = sorted[sorted.length - 1][0];

            // Show archetype
            const arch = archetypes[highest];
            document.getElementById('archetype-card').innerHTML = `
                <div class="archetype-icon">${arch.icon}</div>
                <div class="archetype-label">Jouw sterkste modus (nu)</div>
                <div class="archetype-name">${arch.name}</div>
                <div class="archetype-subtitle">${arch.subtitle}</div>
            `;

            // Show score bars
            const scoresHtml = Object.entries(scores).map(([key, value]) => {
                const domain = domains[key];
                const percentage = (value / 10) * 100;
                return `
                    <div class="score-bar ${key}">
                        <div class="score-bar-header">
                            <div class="score-bar-label">
                                <span class="icon">${domain.icon}</span>
                                <span>${domain.name}</span>
                            </div>
                            <div class="score-bar-value">${value}/10</div>
                        </div>
                        <div class="score-bar-track">
                            <div class="score-bar-fill" style="width: ${percentage}%"></div>
                        </div>
                    </div>
                `;
            }).join('');
            document.getElementById('scores-grid').innerHTML = scoresHtml;
        }

        function showGoalScreen() {
            showScreen('screen-goal');

            const sorted = Object.entries(scores).sort((a, b) => a[1] - b[1]);
            const lowest = sorted[0][0];
            const secondLowest = sorted[1][0];

            if (isAdvanced) {
                document.getElementById('goal-subtitle').textContent =
                    'Je scoort hoog op alle domeinen! Kies een verdiepingsdoel.';

                document.getElementById('goal-options').innerHTML = `
                    <div class="goal-card recommended ${selectedGoal === 'verdieping' ? 'selected' : ''}"
                         onclick="selectGoal('verdieping')">
                        <span class="badge">Aanbevolen</span>
                        <h3>üåü Verdieping</h3>
                        <p>Daag jezelf uit met geavanceerde technieken om nog scherper te worden.</p>
                    </div>
                    <div class="goal-card ${selectedGoal === lowest ? 'selected' : ''}"
                         onclick="selectGoal('${lowest}')">
                        <h3>${domains[lowest].icon} ${domains[lowest].name}</h3>
                        <p>${domains[lowest].description}</p>
                    </div>
                `;
            } else {
                document.getElementById('goal-subtitle').textContent =
                    `Je grootste groeikans ligt bij ${domains[lowest].name.toLowerCase()}.`;

                document.getElementById('goal-options').innerHTML = `
                    <div class="goal-card recommended ${selectedGoal === lowest ? 'selected' : ''}"
                         onclick="selectGoal('${lowest}')">
                        <span class="badge">Aanbevolen</span>
                        <h3>${domains[lowest].icon} ${domains[lowest].name}</h3>
                        <p>${domains[lowest].description}</p>
                    </div>
                    <div class="goal-card ${selectedGoal === secondLowest ? 'selected' : ''}"
                         onclick="selectGoal('${secondLowest}')">
                        <h3>${domains[secondLowest].icon} ${domains[secondLowest].name}</h3>
                        <p>${domains[secondLowest].description}</p>
                    </div>
                `;
            }
        }

        function selectGoal(goal) {
            selectedGoal = goal;
            document.querySelectorAll('.goal-card').forEach(card => {
                card.classList.toggle('selected', card.onclick.toString().includes(`'${goal}'`));
            });
            document.getElementById('btn-goal-next').disabled = false;
        }

        function showChallengeScreen() {
            showScreen('screen-challenge');

            const goalChallenges = challenges[selectedGoal] || challenges.verdieping;
            const goalName = selectedGoal === 'verdieping' ? 'Verdieping' : domains[selectedGoal].name;

            document.getElementById('challenge-subtitle').textContent =
                `Kies √©√©n ${goalName.toLowerCase()}-tactiek voor de komende 2 weken.`;

            const challengesHtml = goalChallenges.map((ch, i) => `
                <div class="challenge-option ${selectedChallenge === i ? 'selected' : ''}"
                     onclick="selectChallenge(${i})">
                    <h4>${ch.name}</h4>
                    <p>${ch.description}</p>
                </div>
            `).join('');
            document.getElementById('challenge-options').innerHTML = challengesHtml;
        }

        function selectChallenge(index) {
            selectedChallenge = index;
            document.querySelectorAll('.challenge-option').forEach((opt, i) => {
                opt.classList.toggle('selected', i === index);
            });
            document.getElementById('btn-challenge-next').disabled = false;
        }

        function showTicketScreen() {
            showScreen('screen-ticket');

            const sorted = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const highest = sorted[0][0];
            const arch = archetypes[highest];

            const goalName = selectedGoal === 'verdieping' ? 'Verdieping' : domains[selectedGoal].name;
            const goalChallenges = challenges[selectedGoal] || challenges.verdieping;
            const challenge = goalChallenges[selectedChallenge];

            const today = new Date().toLocaleDateString('nl-NL', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });

            document.getElementById('ticket').innerHTML = `
                <div class="ticket-header">
                    <h2>üé´ Philo-Scan Ticket</h2>
                    <p>Filosofie ‚Äî Oostvaarders College</p>
                </div>
                <div class="ticket-body">
                    <div class="ticket-row">
                        <span class="ticket-label">Datum</span>
                        <span class="ticket-value">${today}</span>
                    </div>
                    <div class="ticket-row">
                        <span class="ticket-label">Sterkste modus (nu)</span>
                        <span class="ticket-value">${arch.icon} ${arch.name}</span>
                    </div>
                    <div class="ticket-row">
                        <span class="ticket-label">Groeidoel</span>
                        <span class="ticket-value">${goalName}</span>
                    </div>
                    <div class="ticket-challenge">
                        <h4>Mijn challenge (2 weken)</h4>
                        <p>${challenge.name}: ${challenge.description}</p>
                    </div>
                </div>
                <div class="ticket-footer">
                    Succes met je challenge! üöÄ
                </div>
            `;
        }

        function retryTest() {
            currentQuestion = 0;
            answers = {};
            scores = {};
            selectedGoal = null;
            selectedChallenge = null;
            isAdvanced = false;
            showScreen('screen-intro');
        }
    </script>
</body>
</html>
